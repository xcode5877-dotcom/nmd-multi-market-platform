{"version":3,"sources":["../src/seed.ts","../src/catalog-seed.ts","../src/campaign-store.ts","../src/campaign-seed.ts","../src/delivery-seed.ts","../src/template-store.ts","../src/staff-store.ts","../src/mock-api-client.ts","../src/index.ts"],"sourcesContent":["import type { RegistryTenant } from './types';\r\n\r\nconst DEMO_TENANTS: Omit<RegistryTenant, 'id' | 'createdAt'>[] = [\r\n  {\r\n    slug: 'buffalo28',\r\n    name: 'Buffalo28 Pizza',\r\n    logoUrl: '/logo-pizza.svg',\r\n    primaryColor: '#b91c1c',\r\n    secondaryColor: '#fbbf24',\r\n    fontFamily: '\"Cairo\", system-ui, sans-serif',\r\n    radiusScale: 1.25,\r\n    layoutStyle: 'default',\r\n    enabled: true,\r\n    type: 'FOOD',\r\n  },\r\n  {\r\n    slug: 'ms-brands',\r\n    name: 'MS Brands',\r\n    logoUrl: '/logo.svg',\r\n    primaryColor: '#059669',\r\n    secondaryColor: '#d4a574',\r\n    fontFamily: '\"Cairo\", system-ui, sans-serif',\r\n    radiusScale: 1,\r\n    layoutStyle: 'default',\r\n    enabled: true,\r\n  },\r\n  {\r\n    slug: 'pizza',\r\n    name: 'NMD Pizzeria',\r\n    logoUrl: '/logo-pizza.svg',\r\n    primaryColor: '#b91c1c',\r\n    secondaryColor: '#fbbf24',\r\n    fontFamily: '\"Cairo\", system-ui, sans-serif',\r\n    radiusScale: 1.25,\r\n    layoutStyle: 'default',\r\n    enabled: true,\r\n    type: 'FOOD',\r\n  },\r\n  {\r\n    slug: 'groceries',\r\n    name: 'NMD Groceries',\r\n    logoUrl: '/logo.svg',\r\n    primaryColor: '#059669',\r\n    secondaryColor: '#d4a574',\r\n    fontFamily: '\"Cairo\", system-ui, sans-serif',\r\n    radiusScale: 1,\r\n    layoutStyle: 'default',\r\n    enabled: true,\r\n  },\r\n  {\r\n    slug: 'apparel',\r\n    name: 'NMD Apparel',\r\n    logoUrl: '/logo.svg',\r\n    primaryColor: '#7c3aed',\r\n    secondaryColor: '#a78bfa',\r\n    fontFamily: '\"Cairo\", system-ui, sans-serif',\r\n    radiusScale: 1,\r\n    layoutStyle: 'default',\r\n    enabled: true,\r\n  },\r\n];\r\n\r\nexport function seedTenants(): void {\r\n  const existing = loadTenants();\r\n  if (existing.length > 0) return;\r\n\r\n  const created = new Date().toISOString();\r\n  const tenants: RegistryTenant[] = DEMO_TENANTS.map((t, i) => ({\r\n    ...t,\r\n    id: `tenant-${i + 1}`,\r\n    createdAt: created,\r\n  }));\r\n  localStorage.setItem('nmd.tenants', JSON.stringify(tenants));\r\n}\r\n\r\nfunction loadTenants(): RegistryTenant[] {\r\n  try {\r\n    const raw = localStorage.getItem('nmd.tenants');\r\n    return raw ? JSON.parse(raw) : [];\r\n  } catch {\r\n    return [];\r\n  }\r\n}\r\n","import type { Category, Product } from '@nmd/core';\r\nimport { getCatalog, setCatalog } from './catalog-store';\r\n\r\nfunction seedTenantCatalog(tenantId: string, slug: string, categories: Category[], products: Product[]): void {\r\n  const existing = getCatalog(tenantId);\r\n  if (existing.categories.length > 0 || existing.products.length > 0) return;\r\n\r\n  const cats = categories.map((c) => ({ ...c, tenantId }));\r\n  const prods = products.map((p) => ({ ...p, tenantId }));\r\n  setCatalog(tenantId, { categories: cats, products: prods, optionGroups: existing.optionGroups ?? [] });\r\n}\r\n\r\nconst PIZZA_CATEGORIES: Category[] = [\r\n  { id: 'pcat-1', tenantId: '', name: 'Pizzas', slug: 'pizzas', sortOrder: 0 },\r\n  { id: 'pcat-2', tenantId: '', name: 'Sides', slug: 'sides', sortOrder: 1 },\r\n];\r\n\r\nconst PIZZA_PRODUCTS: Product[] = [\r\n  {\r\n    id: 'pprod-1',\r\n    tenantId: '',\r\n    categoryId: 'pcat-1',\r\n    name: 'Margherita Pizza',\r\n    slug: 'margherita',\r\n    type: 'PIZZA',\r\n    basePrice: 55,\r\n    currency: 'ILS',\r\n    images: [{ id: 'pimg-1', url: 'https://placehold.co/400x300?text=Pizza', sortOrder: 0 }],\r\n    optionGroups: [\r\n      {\r\n        id: 'pog-1',\r\n        name: 'Size',\r\n        type: 'SIZE',\r\n        required: true,\r\n        minSelected: 1,\r\n        maxSelected: 1,\r\n        selectionType: 'single',\r\n        items: [\r\n          { id: 'poi-1', name: 'Regular', priceModifier: 0, sortOrder: 0 },\r\n          { id: 'poi-2', name: 'Large', priceModifier: 15, sortOrder: 1 },\r\n        ],\r\n      },\r\n      {\r\n        id: 'pog-2',\r\n        name: 'Extra Toppings',\r\n        type: 'CUSTOM',\r\n        required: false,\r\n        minSelected: 0,\r\n        maxSelected: 3,\r\n        selectionType: 'multi',\r\n        allowHalfPlacement: true,\r\n        items: [\r\n          { id: 'poi-3', name: 'Mushrooms', priceModifier: 5, sortOrder: 0, placement: 'HALF' as const },\r\n          { id: 'poi-4', name: 'Olives', priceModifier: 4, sortOrder: 1, placement: 'HALF' as const },\r\n        ],\r\n      },\r\n    ],\r\n    isAvailable: true,\r\n  },\r\n];\r\n\r\nconst GROCERIES_CATEGORIES: Category[] = [\r\n  { id: 'gcat-1', tenantId: '', name: 'Fruits', slug: 'fruits', sortOrder: 0 },\r\n  { id: 'gcat-2', tenantId: '', name: 'Vegetables', slug: 'vegetables', sortOrder: 1 },\r\n];\r\n\r\nconst GROCERIES_PRODUCTS: Product[] = [\r\n  {\r\n    id: 'gprod-1',\r\n    tenantId: '',\r\n    categoryId: 'gcat-1',\r\n    name: 'Fresh Apples',\r\n    slug: 'fresh-apples',\r\n    type: 'SIMPLE',\r\n    basePrice: 12,\r\n    currency: 'ILS',\r\n    images: [{ id: 'gimg-1', url: 'https://placehold.co/400x300?text=Apples', sortOrder: 0 }],\r\n    optionGroups: [],\r\n    isAvailable: true,\r\n  },\r\n  {\r\n    id: 'gprod-2',\r\n    tenantId: '',\r\n    categoryId: 'gcat-2',\r\n    name: 'Organic Tomatoes',\r\n    slug: 'organic-tomatoes',\r\n    type: 'SIMPLE',\r\n    basePrice: 8,\r\n    currency: 'ILS',\r\n    images: [{ id: 'gimg-2', url: 'https://placehold.co/400x300?text=Tomatoes', sortOrder: 0 }],\r\n    optionGroups: [],\r\n    isAvailable: true,\r\n  },\r\n];\r\n\r\nconst APPAREL_CATEGORIES: Category[] = [\r\n  { id: 'acat-1', tenantId: '', name: 'T-Shirts', slug: 't-shirts', sortOrder: 0 },\r\n  { id: 'acat-2', tenantId: '', name: 'Pants', slug: 'pants', sortOrder: 1 },\r\n];\r\n\r\nconst APPAREL_PRODUCTS: Product[] = [\r\n  {\r\n    id: 'aprod-1',\r\n    tenantId: '',\r\n    categoryId: 'acat-1',\r\n    name: 'Classic Tee',\r\n    slug: 'classic-tee',\r\n    type: 'APPAREL',\r\n    basePrice: 89,\r\n    currency: 'ILS',\r\n    images: [{ id: 'aimg-1', url: 'https://placehold.co/400x300?text=Tee', sortOrder: 0 }],\r\n    optionGroups: [\r\n      {\r\n        id: 'aog-1',\r\n        name: 'Size',\r\n        required: true,\r\n        minSelected: 1,\r\n        maxSelected: 1,\r\n        selectionType: 'single',\r\n        items: [\r\n          { id: 'aoi-1', name: 'S', priceModifier: 0, sortOrder: 0 },\r\n          { id: 'aoi-2', name: 'M', priceModifier: 0, sortOrder: 1 },\r\n          { id: 'aoi-3', name: 'L', priceModifier: 0, sortOrder: 2 },\r\n        ],\r\n      },\r\n    ],\r\n    isAvailable: true,\r\n  },\r\n];\r\n\r\nexport function seedCatalogForTenants(): void {\r\n  const tenants = JSON.parse(localStorage.getItem('nmd.tenants') ?? '[]') as { id: string; slug: string }[];\r\n  for (const t of tenants) {\r\n    if (t.slug === 'pizza' || t.slug === 'buffalo28') {\r\n      seedTenantCatalog(t.id, t.slug, PIZZA_CATEGORIES, PIZZA_PRODUCTS);\r\n    } else if (t.slug === 'groceries') {\r\n      seedTenantCatalog(t.id, t.slug, GROCERIES_CATEGORIES, GROCERIES_PRODUCTS);\r\n    } else if (t.slug === 'apparel') {\r\n      seedTenantCatalog(t.id, t.slug, APPAREL_CATEGORIES, APPAREL_PRODUCTS);\r\n    }\r\n  }\r\n}\r\n","import type { Campaign } from '@nmd/core';\r\n\r\nconst STORAGE_KEY = 'nmd.campaigns';\r\n\r\nfunction load(): Campaign[] {\r\n  try {\r\n    const raw = localStorage.getItem(STORAGE_KEY);\r\n    if (raw) return JSON.parse(raw);\r\n  } catch {\r\n    /* ignore */\r\n  }\r\n  return [];\r\n}\r\n\r\nfunction save(data: Campaign[]): void {\r\n  localStorage.setItem(STORAGE_KEY, JSON.stringify(data));\r\n}\r\n\r\nexport function listCampaigns(tenantId: string): Campaign[] {\r\n  return load().filter((c) => c.tenantId === tenantId);\r\n}\r\n\r\nexport function getCampaign(id: string): Campaign | null {\r\n  return load().find((c) => c.id === id) ?? null;\r\n}\r\n\r\nexport function createCampaign(input: Omit<Campaign, 'id'>): Campaign {\r\n  const id = crypto.randomUUID?.() ?? `camp-${Date.now()}`;\r\n  const campaign: Campaign = { ...input, id };\r\n  const data = load();\r\n  data.push(campaign);\r\n  save(data);\r\n  return campaign;\r\n}\r\n\r\nexport function updateCampaign(id: string, updates: Partial<Omit<Campaign, 'id'>>): Campaign | null {\r\n  const data = load();\r\n  const idx = data.findIndex((c) => c.id === id);\r\n  if (idx === -1) return null;\r\n  data[idx] = { ...data[idx], ...updates } as Campaign;\r\n  save(data);\r\n  return data[idx];\r\n}\r\n\r\nexport function deleteCampaign(id: string): boolean {\r\n  const data = load().filter((c) => c.id !== id);\r\n  if (data.length === load().length) return false;\r\n  save(data);\r\n  return true;\r\n}\r\n\r\nexport function toggleCampaignStatus(id: string): Campaign | null {\r\n  const c = getCampaign(id);\r\n  if (!c) return null;\r\n  const next = c.status === 'active' ? 'paused' : 'active';\r\n  return updateCampaign(id, { status: next });\r\n}\r\n","import { listTenants } from './tenant-registry';\r\nimport { createCampaign } from './campaign-store';\r\n\r\nexport function seedCampaigns(): void {\r\n  const tenants = listTenants();\r\n  const existing = loadCampaigns();\r\n  if (existing.length > 0) return;\r\n\r\n  const pizza = tenants.find((t) => t.slug === 'pizza');\r\n  const groceries = tenants.find((t) => t.slug === 'groceries');\r\n\r\n  if (pizza) {\r\n    createCampaign({\r\n      tenantId: pizza.id,\r\n      name: 'خصم البيتزا',\r\n      status: 'active',\r\n      type: 'PERCENT',\r\n      value: 15,\r\n      appliesTo: 'ALL',\r\n      stackable: false,\r\n      priority: 1,\r\n    });\r\n  }\r\n  if (groceries) {\r\n    createCampaign({\r\n      tenantId: groceries.id,\r\n      name: 'خصم ثابت',\r\n      status: 'active',\r\n      type: 'FIXED',\r\n      value: 5,\r\n      appliesTo: 'ALL',\r\n      stackable: false,\r\n      priority: 1,\r\n    });\r\n  }\r\n}\r\n\r\nfunction loadCampaigns(): { id: string }[] {\r\n  try {\r\n    const raw = localStorage.getItem('nmd.campaigns');\r\n    return raw ? JSON.parse(raw) : [];\r\n  } catch {\r\n    return [];\r\n  }\r\n}\r\n","import type { DeliveryZone } from '@nmd/core';\r\nimport { listTenants } from './tenant-registry';\r\nimport { getDeliverySettings, saveDeliverySettings } from './delivery-store';\r\nimport { getDeliveryZones, setDeliveryZones } from './delivery-zones-store';\r\n\r\nexport function seedDelivery(): void {\r\n  const tenants = listTenants();\r\n  for (const t of tenants) {\r\n    if (getDeliverySettings(t.id)) continue;\r\n    saveDeliverySettings(t.id, {\r\n      tenantId: t.id,\r\n      modes: { pickup: true, delivery: true },\r\n      deliveryFee: 5,\r\n      zones: [],\r\n    });\r\n  }\r\n}\r\n\r\nconst BUFFALO_ZONES: Omit<DeliveryZone, 'id' | 'tenantId'>[] = [\r\n  { name: 'المنطقة الوسطى', fee: 15, etaMinutes: 30, isActive: true, sortOrder: 0 },\r\n  { name: 'الشمال', fee: 20, etaMinutes: 45, isActive: true, sortOrder: 1 },\r\n  { name: 'الجنوب', fee: 18, etaMinutes: 40, isActive: true, sortOrder: 2 },\r\n  { name: 'الشرق', fee: 22, etaMinutes: 50, isActive: true, sortOrder: 3 },\r\n  { name: 'الغرب', fee: 25, etaMinutes: 55, isActive: true, sortOrder: 4 },\r\n  { name: 'ضواحي', fee: 30, etaMinutes: 60, isActive: true, sortOrder: 5 },\r\n  { name: 'خارج المدينة', fee: 40, etaMinutes: 90, isActive: true, sortOrder: 6 },\r\n];\r\n\r\nexport function seedDeliveryZones(): void {\r\n  const tenants = listTenants();\r\n  for (const t of tenants) {\r\n    if (getDeliveryZones(t.id).length > 0) continue;\r\n    const slug = (t as { slug?: string }).slug ?? '';\r\n    let zones: DeliveryZone[];\r\n    if (slug === 'buffalo28' || slug === 'pizza') {\r\n      zones = BUFFALO_ZONES.map((z, i) => ({ ...z, id: `dz-${t.id}-${i + 1}`, tenantId: t.id }));\r\n    } else if (slug === 'ms-brands') {\r\n      zones = [{ id: `dz-${t.id}-1`, tenantId: t.id, name: 'التوصيل العام', fee: 10, etaMinutes: 45, isActive: true, sortOrder: 0 }];\r\n    } else {\r\n      zones = [{ id: `dz-${t.id}-1`, tenantId: t.id, name: 'المنطقة الافتراضية', fee: 10, etaMinutes: 45, isActive: true, sortOrder: 0 }];\r\n    }\r\n    setDeliveryZones(t.id, zones);\r\n  }\r\n}\r\n","import type { Template } from '@nmd/core';\r\n\r\nconst STORAGE_KEY = 'nmd.templates';\r\n\r\nfunction load(): Template[] {\r\n  try {\r\n    const raw = localStorage.getItem(STORAGE_KEY);\r\n    if (raw) return JSON.parse(raw);\r\n  } catch {\r\n    /* ignore */\r\n  }\r\n  return [];\r\n}\r\n\r\nfunction save(templates: Template[]): void {\r\n  localStorage.setItem(STORAGE_KEY, JSON.stringify(templates));\r\n}\r\n\r\nexport function listTemplates(): Template[] {\r\n  return load();\r\n}\r\n\r\nexport function getTemplate(id: string): Template | null {\r\n  return load().find((t) => t.id === id) ?? null;\r\n}\r\n\r\nexport function seedTemplates(): void {\r\n  const existing = load();\r\n  if (existing.length > 0) return;\r\n\r\n  const templates: Template[] = [\r\n    { id: 't-minimal', name: 'بسيط', layoutStyle: 'minimal' },\r\n    { id: 't-cozy', name: 'مريح', layoutStyle: 'cozy' },\r\n    { id: 't-bold', name: 'واضح', layoutStyle: 'bold' },\r\n    { id: 't-modern', name: 'حديث', layoutStyle: 'modern' },\r\n  ];\r\n  save(templates);\r\n}\r\n","import type { StaffUser } from '@nmd/core';\r\nimport { generateId } from '@nmd/core';\r\nimport { listTenants } from './tenant-registry';\r\n\r\nconst STORAGE_KEY = 'nmd.staff';\r\n\r\nfunction load(): StaffUser[] {\r\n  try {\r\n    const raw = localStorage.getItem(STORAGE_KEY);\r\n    if (raw) return JSON.parse(raw);\r\n  } catch {\r\n    /* ignore */\r\n  }\r\n  return [];\r\n}\r\n\r\nfunction save(staff: StaffUser[]): void {\r\n  localStorage.setItem(STORAGE_KEY, JSON.stringify(staff));\r\n}\r\n\r\nexport function listStaff(tenantId: string): StaffUser[] {\r\n  return load().filter((s) => s.tenantId === tenantId);\r\n}\r\n\r\nexport function addStaff(input: Omit<StaffUser, 'id' | 'createdAt'>): StaffUser {\r\n  const user: StaffUser = {\r\n    ...input,\r\n    id: generateId(),\r\n    createdAt: new Date().toISOString(),\r\n  };\r\n  const all = load();\r\n  all.push(user);\r\n  save(all);\r\n  return user;\r\n}\r\n\r\nexport function updateStaff(id: string, updates: Partial<Omit<StaffUser, 'id' | 'tenantId' | 'createdAt'>>): StaffUser | null {\r\n  const all = load();\r\n  const idx = all.findIndex((s) => s.id === id);\r\n  if (idx === -1) return null;\r\n  all[idx] = { ...all[idx], ...updates };\r\n  save(all);\r\n  return all[idx];\r\n}\r\n\r\nexport function removeStaff(id: string): void {\r\n  save(load().filter((s) => s.id !== id));\r\n}\r\n\r\nexport function seedStaff(): void {\r\n  const existing = load();\r\n  if (existing.length > 0) return;\r\n\r\n  const tenants = listTenants();\r\n  const now = new Date().toISOString();\r\n  const staff: StaffUser[] = tenants.map((t) => ({\r\n    id: generateId(),\r\n    tenantId: t.id,\r\n    name: `مالك ${t.name}`,\r\n    role: 'OWNER' as const,\r\n    createdAt: now,\r\n  }));\r\n  save(staff);\r\n}\r\n","import type { ApiClient } from '@nmd/core';\nimport type { Tenant, Category, Product, Order, OrderPayload, Campaign, DeliverySettings, DeliveryZone, OptionGroup, OptionItem } from '@nmd/core';\nimport { generateId } from '@nmd/core';\nimport {\n  getTenantById,\n  getTenantBySlug,\n  listEnabledTenants,\n} from './tenant-registry';\nimport { getCatalog, listOptionGroups, listOptionItemsByGroup } from './catalog-store';\nimport { addOrder, getOrder } from './orders-store';\nimport { getTemplate } from './template-store';\nimport { listCampaigns } from './campaign-store';\nimport { getDeliverySettings as getDeliverySettingsStore } from './delivery-store';\nimport { getDeliveryZones as getDeliveryZonesStore } from './delivery-zones-store';\nimport type { RegistryTenant, MarketCourier, MarketCourierWithStats } from './types';\n\nconst MOCK_API_URL =\n  (typeof import.meta !== 'undefined' && (import.meta as { env?: Record<string, string> }).env?.VITE_MOCK_API_URL) ||\n  '';\n/** Must match AuthContext TOKEN_KEY in apps/nmd-admin - same localStorage key for JWT */\nconst TOKEN_KEY = 'nmd-access-token';\n/** Customer OTP token - used by storefront for POST /orders when logged in */\nexport const CUSTOMER_TOKEN_KEY = 'nmd-customer-token';\n\n/** Token provider for admin apps (e.g. nmd-admin). When set, used instead of localStorage for auth. */\nlet tokenProvider: (() => string | null) | null = null;\n\nexport function setMockApiTokenProvider(fn: () => string | null): void {\n  tokenProvider = fn;\n}\n\nfunction getToken(): string | null {\n  const fromProvider = tokenProvider?.() ?? null;\n  const fromStorage = typeof localStorage !== 'undefined' ? localStorage.getItem(TOKEN_KEY) : null;\n  return fromProvider ?? fromStorage;\n}\n\nfunction getCustomerToken(): string | null {\n  return typeof localStorage !== 'undefined' ? localStorage.getItem(CUSTOMER_TOKEN_KEY) : null;\n}\n\nfunction getApiHeaders(init?: RequestInit): Record<string, string> {\n  const h: Record<string, string> = { 'Content-Type': 'application/json', ...(init?.headers as Record<string, string>) };\n  const token = getToken() ?? getCustomerToken();\n  if (token) {\n    h['Authorization'] = `Bearer ${token}`;\n  }\n  const emergency = (typeof window !== 'undefined' && (window as { __NMD_EMERGENCY_HEADERS__?: Record<string, string> }).__NMD_EMERGENCY_HEADERS__);\n  if (emergency) Object.assign(h, emergency);\n  return h;\n}\n\nfunction mergeEmergencyMeta(body: string | undefined, method: string): string | undefined {\n  const reason = typeof window !== 'undefined' ? (window as { __NMD_EMERGENCY_REASON__?: string }).__NMD_EMERGENCY_REASON__ : undefined;\n  if (!reason) return body;\n  const isWrite = ['POST', 'PUT', 'PATCH', 'DELETE'].includes((method || 'GET').toUpperCase());\n  if (!isWrite) return body;\n  try {\n    const parsed = body ? JSON.parse(body) : {};\n    const merged = { ...parsed, _meta: { ...parsed._meta, emergencyReason: reason } };\n    return JSON.stringify(merged);\n  } catch {\n    return body;\n  }\n}\n\nfunction normalizeHero(h: import('@nmd/core').StorefrontHero | undefined) {\n  const defaultHero = { title: 'مرحباً بك', subtitle: 'اكتشف أفضل المنتجات لدينا', ctaText: 'تسوق الآن', ctaLink: '#', ctaHref: '#' };\n  const base = h ?? defaultHero;\n  const cta = base.ctaHref ?? base.ctaLink ?? '#';\n  return { ...base, ctaLink: cta, ctaHref: cta };\n}\n\nfunction registryToTenant(r: RegistryTenant & { hero?: import('@nmd/core').StorefrontHero; banners?: import('@nmd/core').StorefrontBanner[] }): Tenant {\n  const template = r.templateId ? getTemplate(r.templateId) : null;\n  const layoutStyle = template?.layoutStyle ?? r.layoutStyle;\n  const type = (r.type === 'CLOTHING' || r.type === 'FOOD') ? r.type : 'GENERAL';\n  return {\n    id: r.id,\n    name: r.name,\n    slug: r.slug,\n    type,\n    marketCategory: r.marketCategory ?? 'GENERAL',\n    paymentCapabilities: r.paymentCapabilities ?? { cash: true, card: false },\n    branding: {\n      logoUrl: r.logoUrl ?? '',\n      primaryColor: r.primaryColor ?? '#0f766e',\n      secondaryColor: r.secondaryColor ?? '#d4a574',\n      fontFamily: r.fontFamily ?? '\"Cairo\", system-ui, sans-serif',\n      radiusScale: r.radiusScale ?? 1,\n      layoutStyle: layoutStyle as import('@nmd/core').TenantBranding['layoutStyle'],\n      hero: normalizeHero(r.hero),\n      banners: r.banners ?? [],\n      whatsappPhone: r.whatsappPhone,\n    },\n  };\n}\n\nfunction resolveTenant(idOrSlug: string): { id: string; tenant: Tenant } | null {\n  const byId = getTenantById(idOrSlug);\n  if (byId && byId.enabled) {\n    return { id: byId.id, tenant: registryToTenant(byId) };\n  }\n  const bySlug = getTenantBySlug(idOrSlug);\n  if (bySlug && bySlug.enabled) {\n    return { id: bySlug.id, tenant: registryToTenant(bySlug) };\n  }\n  return null;\n}\n\nfunction delay(ms: number): Promise<void> {\n  return new Promise((r) => setTimeout(r, ms));\n}\n\n/** Public fetch - no auth. For endpoints that don't require JWT (e.g. GET /public/orders/:id). */\nasync function publicFetch<T>(path: string): Promise<T> {\n  const res = await fetch(`${MOCK_API_URL}${path}`, {\n    method: 'GET',\n    headers: { 'Content-Type': 'application/json' },\n  });\n  if (!res.ok) {\n    if (res.status === 404) throw new Error('NOT_FOUND');\n    throw new Error(`API error: ${res.status}`);\n  }\n  return res.json();\n}\n\nasync function apiFetch<T>(path: string, init?: RequestInit): Promise<T> {\n  const method = init?.method ?? 'GET';\n  const body = mergeEmergencyMeta(init?.body as string | undefined, method);\n  const headers = getApiHeaders(init);\n  const isPublicOrder = method === 'POST' && path === '/orders';\n  if (!headers['Authorization'] && MOCK_API_URL && !isPublicOrder) {\n    console.warn(`[MockApiClient] Protected request to ${path} without token. Ensure you are logged in and token is in localStorage (key: ${TOKEN_KEY}).`);\n  }\n  const res = await fetch(`${MOCK_API_URL}${path}`, {\n    ...init,\n    method,\n    body,\n    headers,\n  });\n  if (!res.ok) {\n    if (res.status === 404) throw new Error('NOT_FOUND');\n    try {\n      const err = (await res.json()) as { error?: string; code?: string };\n      if (err.code === 'EMERGENCY_MODE_REQUIRED') {\n        throw new Error('Emergency mode required');\n      }\n      throw new Error(err.error ?? `API error: ${res.status}`);\n    } catch (e) {\n      if (e instanceof Error) throw e;\n      throw new Error(`API error: ${res.status}`);\n    }\n  }\n  if (res.status === 204) return undefined as T;\n  return res.json();\n}\n\n/** Upload files to mock-api; returns URLs. Only works when VITE_MOCK_API_URL is set. */\nexport async function uploadFiles(files: File[]): Promise<string[]> {\n  if (!MOCK_API_URL || files.length === 0) return [];\n  const form = new FormData();\n  files.forEach((f) => form.append('files', f));\n  const res = await fetch(`${MOCK_API_URL}/upload`, {\n    method: 'POST',\n    body: form,\n  });\n  if (!res.ok) throw new Error(`Upload failed: ${res.status}`);\n  const data = (await res.json()) as { urls: string[] };\n  return data.urls ?? [];\n}\n\nexport class MockApiClient implements ApiClient {\n  private get useApi(): boolean {\n    return !!MOCK_API_URL;\n  }\n\n  async getTenant(tenantIdOrSlug: string): Promise<Tenant | null> {\n    if (this.useApi) {\n      try {\n        const isUuid = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(tenantIdOrSlug);\n        const path = isUuid ? `/tenants/by-id/${tenantIdOrSlug}` : `/tenants/by-slug/${tenantIdOrSlug}`;\n        const r = await apiFetch<RegistryTenant>(path);\n        if (r && r.enabled) return registryToTenant(r);\n        return null;\n      } catch {\n        return null;\n      }\n    }\n    await delay(100);\n    const resolved = resolveTenant(tenantIdOrSlug);\n    return resolved?.tenant ?? null;\n  }\n\n  async getMenu(tenantId: string): Promise<Category[]> {\n    if (this.useApi) {\n      try {\n        const catalog = await apiFetch<{ categories: Category[] }>(`/catalog/${tenantId}`);\n        const categories = (catalog?.categories ?? [])\n          .filter((c) => (c as Category).isVisible !== false)\n          .map((c) => ({ ...c, parentId: (c as Category).parentId ?? null }));\n        return [...categories].sort((a, b) => ((a as Category).sortOrder ?? 0) - ((b as Category).sortOrder ?? 0));\n      } catch {\n        return [];\n      }\n    }\n    await delay(80);\n    try {\n      const catalog = getCatalog(tenantId);\n      const categories = (catalog?.categories ?? []).filter((c) => c.isVisible !== false);\n      return [...categories].sort((a, b) => (a.sortOrder ?? 0) - (b.sortOrder ?? 0));\n    } catch {\n      return [];\n    }\n  }\n\n  async getProduct(tenantId: string, productId: string): Promise<Product | null> {\n    if (this.useApi) {\n      try {\n        const catalog = await apiFetch<{ products: Product[] }>(`/catalog/${tenantId}`);\n        const products = catalog?.products ?? [];\n        return (products.find((p) => p.id === productId) as Product) ?? null;\n      } catch {\n        return null;\n      }\n    }\n    await delay(80);\n    try {\n      const catalog = getCatalog(tenantId);\n      const products = catalog?.products ?? [];\n      return products.find((p) => p.id === productId) ?? null;\n    } catch {\n      return null;\n    }\n  }\n\n  async getProducts(tenantId: string, categoryId?: string): Promise<Product[]> {\n    if (this.useApi) {\n      try {\n        const catalog = await apiFetch<{ products: Product[] }>(`/catalog/${tenantId}`);\n        let products = catalog?.products ?? [];\n        if (categoryId) products = products.filter((p) => (p as Product).categoryId === categoryId);\n        return products as Product[];\n      } catch {\n        return [];\n      }\n    }\n    await delay(80);\n    try {\n      const catalog = getCatalog(tenantId);\n      const products = catalog?.products ?? [];\n      if (categoryId) {\n        return products.filter((p) => p.categoryId === categoryId);\n      }\n      return products;\n    } catch {\n      return [];\n    }\n  }\n\n  async createOrder(tenantId: string, payload: OrderPayload): Promise<Order> {\n    const subtotal = payload.items.reduce((sum, item) => sum + item.totalPrice, 0);\n    const deliveryFee = payload.delivery?.fee ?? 0;\n    const total = subtotal + deliveryFee;\n    const order: Order = {\n      id: generateId(),\n      tenantId,\n      status: 'PENDING',\n      fulfillmentType: payload.fulfillmentType,\n      paymentMethod: payload.paymentMethod,\n      items: payload.items,\n      subtotal,\n      total,\n      currency: 'ILS',\n      createdAt: new Date().toISOString(),\n      notes: payload.notes,\n      customerName: payload.customerName,\n      customerPhone: payload.customerPhone,\n      deliveryAddress: payload.deliveryAddress,\n      delivery: payload.delivery,\n    };\n    if (this.useApi) {\n      const created = await apiFetch<Order>('/orders', {\n        method: 'POST',\n        body: JSON.stringify(order),\n      });\n      return created;\n    }\n    await delay(150);\n    addOrder(order);\n    return order;\n  }\n\n  async getOrder(orderId: string): Promise<Order | null> {\n    if (this.useApi) {\n      try {\n        return await apiFetch<Order>(`/orders/${orderId}`);\n      } catch {\n        return null;\n      }\n    }\n    await delay(80);\n    return getOrder(orderId);\n  }\n\n  /** Public order status - no auth. For storefront success/status pages. */\n  async getPublicOrder(orderId: string): Promise<Order | null> {\n    if (this.useApi) {\n      try {\n        return await publicFetch<Order>(`/public/orders/${encodeURIComponent(orderId)}`);\n      } catch {\n        return null;\n      }\n    }\n    await delay(80);\n    return getOrder(orderId);\n  }\n\n  async getCampaigns(tenantId: string): Promise<Campaign[]> {\n    if (this.useApi) {\n      try {\n        return await apiFetch<Campaign[]>(`/campaigns?tenantId=${encodeURIComponent(tenantId)}`);\n      } catch {\n        return [];\n      }\n    }\n    await delay(80);\n    return listCampaigns(tenantId);\n  }\n\n  async getDeliverySettings(tenantId: string): Promise<DeliverySettings | null> {\n    if (this.useApi) {\n      try {\n        return await apiFetch<DeliverySettings | null>(`/delivery/${tenantId}`);\n      } catch {\n        return null;\n      }\n    }\n    await delay(80);\n    return getDeliverySettingsStore(tenantId);\n  }\n\n  async getDeliveryZones(tenantId: string): Promise<DeliveryZone[]> {\n    if (this.useApi) {\n      try {\n        return await apiFetch<DeliveryZone[]>(`/tenants/${tenantId}/delivery-zones`);\n      } catch {\n        return [];\n      }\n    }\n    await delay(80);\n    const zones = getDeliveryZonesStore(tenantId);\n    if (zones.length > 0) return zones;\n    const settings = getDeliverySettingsStore(tenantId);\n    const legacy = settings?.zones ?? [];\n    return legacy.map((z) => ({\n      id: (z as { id?: string }).id ?? `legacy-${z.name}`,\n      tenantId,\n      name: z.name,\n      fee: z.fee,\n      etaMinutes: (z as { etaMinutes?: number }).etaMinutes,\n      isActive: ((z as { enabled?: boolean }).enabled ?? (z as { isActive?: boolean }).isActive ?? true),\n      sortOrder: (z as { sortOrder?: number }).sortOrder,\n    }));\n  }\n\n  async getOptionGroups(tenantId: string) {\n    if (this.useApi) {\n      try {\n        const catalog = await apiFetch<{ optionGroups: unknown[] }>(`/catalog/${tenantId}`);\n        return (catalog?.optionGroups ?? []) as Awaited<ReturnType<ApiClient['getOptionGroups']>>;\n      } catch {\n        return [];\n      }\n    }\n    await delay(80);\n    return listOptionGroups(tenantId);\n  }\n\n  async getOptionItems(tenantId: string, groupId: string): Promise<OptionItem[]> {\n    if (this.useApi) {\n      try {\n        const catalog = await apiFetch<{ optionGroups: { id: string; items?: OptionItem[] }[] }>(`/catalog/${tenantId}`);\n        const groups = catalog?.optionGroups ?? [];\n        const g = groups.find((x) => x.id === groupId);\n        return g?.items ?? [];\n      } catch {\n        return [];\n      }\n    }\n    await delay(80);\n    return listOptionItemsByGroup(tenantId, groupId);\n  }\n\n  // --- Admin/OS Control API (used by nmd-admin, admin) ---\n  async getMe(): Promise<{ id: string; email: string; role: string; marketId?: string; tenantId?: string } | null> {\n    if (!this.useApi) return { id: 'local', email: 'local@dev', role: 'ROOT_ADMIN' };\n    try {\n      return await apiFetch<{ id: string; email: string; role: string; marketId?: string; tenantId?: string }>('/auth/me');\n    } catch {\n      return null;\n    }\n  }\n\n  /** Change password (self-service). Requires auth. Uses Authorization header. */\n  async changePassword(currentPassword: string, newPassword: string): Promise<{ ok: boolean }> {\n    if (!this.useApi) throw new Error('Change password requires API');\n    return apiFetch<{ ok: boolean }>('/auth/change-password', {\n      method: 'POST',\n      body: JSON.stringify({ currentPassword, newPassword }),\n    });\n  }\n\n  async listTenants(): Promise<RegistryTenant[]> {\n    if (this.useApi) {\n      return apiFetch<RegistryTenant[]>('/tenants');\n    }\n    const { listTenants: lt } = await import('./tenant-registry');\n    return lt();\n  }\n\n  async createTenant(input: Omit<RegistryTenant, 'id' | 'createdAt'>): Promise<RegistryTenant> {\n    if (this.useApi) {\n      return apiFetch<RegistryTenant>('/tenants', {\n        method: 'POST',\n        body: JSON.stringify(input),\n      });\n    }\n    const { createTenant: ct } = await import('./tenant-registry');\n    return ct(input);\n  }\n\n  /** Create tenant scoped to a market. Uses POST /markets/:marketId/tenants. */\n  async createTenantForMarket(marketId: string, input: Omit<RegistryTenant, 'id' | 'createdAt' | 'marketId'>): Promise<RegistryTenant> {\n    if (this.useApi) {\n      return apiFetch<RegistryTenant>(`/markets/${marketId}/tenants`, {\n        method: 'POST',\n        body: JSON.stringify(input),\n      });\n    }\n    const { createTenant: ct } = await import('./tenant-registry');\n    return ct({ ...input, marketId });\n  }\n\n  async updateTenant(id: string, updates: Partial<Omit<RegistryTenant, 'id' | 'createdAt'>>): Promise<RegistryTenant | null> {\n    if (this.useApi) {\n      const res = await apiFetch<RegistryTenant>(`/tenants/${id}`, {\n        method: 'PUT',\n        body: JSON.stringify(updates),\n      });\n      return res;\n    }\n    const { updateTenant: ut } = await import('./tenant-registry');\n    return ut(id, updates);\n  }\n\n  async toggleTenant(id: string): Promise<RegistryTenant | null> {\n    if (this.useApi) {\n      try {\n        return await apiFetch<RegistryTenant>(`/tenants/${id}/toggle`, { method: 'POST' });\n      } catch {\n        return null;\n      }\n    }\n    const { toggleTenant: tt } = await import('./tenant-registry');\n    return tt(id);\n  }\n\n  async getTenantById(id: string): Promise<RegistryTenant | null> {\n    if (this.useApi) {\n      try {\n        return await apiFetch<RegistryTenant>(`/tenants/by-id/${id}`);\n      } catch {\n        return null;\n      }\n    }\n    return getTenantById(id);\n  }\n\n  async getTenantBySlug(slug: string): Promise<RegistryTenant | null> {\n    if (this.useApi) {\n      try {\n        return await apiFetch<RegistryTenant>(`/tenants/by-slug/${slug}`);\n      } catch {\n        return null;\n      }\n    }\n    return getTenantBySlug(slug);\n  }\n\n  /** PATCH tenant delivery settings (tenantType, deliveryProviderMode, allowMarketCourierFallback, defaultPrepTimeMin) */\n  async patchTenantDeliverySettings(\n    tenantId: string,\n    settings: { tenantType?: string; deliveryProviderMode?: string; allowMarketCourierFallback?: boolean; defaultPrepTimeMin?: number }\n  ): Promise<RegistryTenant> {\n    return apiFetch<RegistryTenant>(`/tenants/${tenantId}/settings/delivery`, {\n      method: 'PATCH',\n      body: JSON.stringify(settings),\n    });\n  }\n\n  /** Mark order as READY (restaurant) */\n  async markOrderReady(tenantId: string, orderId: string): Promise<Order> {\n    return apiFetch<Order>(`/tenants/${tenantId}/orders/${orderId}/ready`, {\n      method: 'POST',\n    });\n  }\n\n  /** Market couriers */\n  async getMarketCouriers(marketId: string): Promise<MarketCourier[]> {\n    return apiFetch<MarketCourier[]>(`/markets/${marketId}/couriers`);\n  }\n\n  /** Market couriers with performance stats (deliveredCountToday, deliveredCountWeek, avgTotalMin, avgPickupToDeliveredMin, onTimeRate) */\n  async getMarketCourierStats(marketId: string): Promise<MarketCourierWithStats[]> {\n    return apiFetch<MarketCourierWithStats[]>(`/markets/${marketId}/couriers/stats`);\n  }\n\n  /** Weekly leaderboard. Returns { leaderboard, myRank }. */\n  async getMarketLeaderboard(marketId: string, period = 'week'): Promise<{\n    leaderboard: { courierId: string; name: string; pointsWeek: number; badgesWeek: string[]; avgTotalMin: number | null; onTimeRate: number | null; rank: number }[];\n    myRank: number | null;\n  }> {\n    return apiFetch(`/markets/${marketId}/leaderboard?period=${period}`);\n  }\n\n  async createMarketCourier(marketId: string, data: { name?: string; phone?: string }): Promise<MarketCourier> {\n    return apiFetch<MarketCourier>(`/markets/${marketId}/couriers`, {\n      method: 'POST',\n      body: JSON.stringify(data),\n    });\n  }\n\n  async patchMarketCourier(\n    marketId: string,\n    courierId: string,\n    updates: { name?: string; phone?: string; isActive?: boolean; isOnline?: boolean; isAvailable?: boolean; capacity?: number }\n  ): Promise<MarketCourier> {\n    return apiFetch<MarketCourier>(`/markets/${marketId}/couriers/${courierId}`, {\n      method: 'PATCH',\n      body: JSON.stringify(updates),\n    });\n  }\n\n  async deleteMarketCourier(marketId: string, courierId: string): Promise<MarketCourier> {\n    return apiFetch<MarketCourier>(`/markets/${marketId}/couriers/${courierId}`, {\n      method: 'DELETE',\n    });\n  }\n\n  /** Market finance summary. Aggregates orders in date range. */\n  async getMarketFinanceSummary(marketId: string, from?: string, to?: string): Promise<{\n    gross: number;\n    itemsTotal: number;\n    deliveryFees: number;\n    commission: number;\n    netToMerchants: number;\n    cashCollected: number;\n    outstandingCash: number;\n    totalOrders: number;\n    deliveredOrders: number;\n    activeDeliveryOrders: number;\n    cashOrders: number;\n  }> {\n    const params = new URLSearchParams();\n    if (from) params.set('from', from);\n    if (to) params.set('to', to);\n    const q = params.toString() ? `?${params}` : '';\n    return apiFetch(`/markets/${marketId}/finance/summary${q}`);\n  }\n\n  /** Market finance by tenant. */\n  async getMarketFinanceTenants(marketId: string, from?: string, to?: string): Promise<{\n    tenantId: string;\n    tenantName: string;\n    gross: number;\n    itemsTotal: number;\n    deliveryFees: number;\n    commission: number;\n    netToMerchant: number;\n    orderCount: number;\n    deliveredCount: number;\n  }[]> {\n    const params = new URLSearchParams();\n    if (from) params.set('from', from);\n    if (to) params.set('to', to);\n    const q = params.toString() ? `?${params}` : '';\n    return apiFetch(`/markets/${marketId}/finance/tenants${q}`);\n  }\n\n  /** Market finance by courier. */\n  async getMarketFinanceCouriers(marketId: string, from?: string, to?: string): Promise<{\n    courierId: string;\n    courierName: string;\n    deliveredCount: number;\n    cashCollectedGross: number;\n    outstandingGross: number;\n    activeUncollectedGross: number;\n  }[]> {\n    const params = new URLSearchParams();\n    if (from) params.set('from', from);\n    if (to) params.set('to', to);\n    const q = params.toString() ? `?${params}` : '';\n    return apiFetch(`/markets/${marketId}/finance/couriers${q}`);\n  }\n\n  /** All orders for a market (from tenants in that market). For market admin orders/dispatch views. */\n  async getMarketOrders(marketId: string): Promise<Order[]> {\n    if (this.useApi) {\n      return apiFetch<Order[]>(`/markets/${marketId}/orders`);\n    }\n    const { listOrdersByTenant } = await import('./orders-store');\n    const { listTenants } = await import('./tenant-registry');\n    const tenantIds = listTenants().filter((t) => (t as { marketId?: string }).marketId === marketId).map((t) => t.id);\n    const all: Order[] = [];\n    for (const tid of tenantIds) {\n      const orders = listOrdersByTenant(tid);\n      all.push(...orders);\n    }\n    return all;\n  }\n\n  /** Dispatch queue (orders eligible for market courier, not yet assigned) */\n  async getDispatchQueue(marketId: string): Promise<Order[]> {\n    return apiFetch<Order[]>(`/markets/${marketId}/dispatch/queue`);\n  }\n\n  /** Assign courier to a MARKET delivery order. Use reassign: true when changing courier on already-assigned order. */\n  async assignCourierToOrder(marketId: string, orderId: string, courierId: string, reassign?: boolean): Promise<Order> {\n    return apiFetch<Order>(`/markets/${marketId}/orders/${encodeURIComponent(orderId)}/assign-courier`, {\n      method: 'POST',\n      body: JSON.stringify({ courierId, reassign }),\n    });\n  }\n\n  /** Unassign courier from a MARKET delivery order. */\n  async unassignCourierFromOrder(marketId: string, orderId: string): Promise<Order> {\n    return apiFetch<Order>(`/markets/${marketId}/orders/${encodeURIComponent(orderId)}/assign-courier`, {\n      method: 'DELETE',\n    });\n  }\n\n  /** Log contact for an order (e.g. WhatsApp message). Appends to contactLog.entries. */\n  async logOrderContact(marketId: string, orderId: string, message?: string): Promise<Order> {\n    return apiFetch<Order>(`/markets/${marketId}/orders/${encodeURIComponent(orderId)}/contact`, {\n      method: 'POST',\n      body: JSON.stringify({ message }),\n    });\n  }\n\n  /** Delivery jobs */\n  async getDeliveryJobs(marketId: string): Promise<{ id: string; marketId: string; courierId?: string; status: string; items: { orderId: string; tenantId: string }[] }[]> {\n    return apiFetch(`/markets/${marketId}/delivery-jobs`);\n  }\n\n  async createDeliveryJob(marketId: string, items: { orderId: string; tenantId: string }[]): Promise<{ id: string; status: string; items: unknown[] }> {\n    return apiFetch(`/markets/${marketId}/delivery-jobs`, {\n      method: 'POST',\n      body: JSON.stringify({ items }),\n    });\n  }\n\n  async assignDeliveryJob(marketId: string, jobId: string, courierId: string): Promise<unknown> {\n    return apiFetch(`/markets/${marketId}/delivery-jobs/${jobId}/assign`, {\n      method: 'PATCH',\n      body: JSON.stringify({ courierId }),\n    });\n  }\n\n  async getCatalogApi(tenantId: string): Promise<{ categories: Category[]; products: Product[]; optionGroups: unknown[]; optionItems: unknown[] }> {\n    if (this.useApi) {\n      return apiFetch(`/catalog/${tenantId}`);\n    }\n    const cat = getCatalog(tenantId);\n    return { ...cat };\n  }\n\n  async setCatalogApi(tenantId: string, catalog: { categories: Category[]; products: Product[]; optionGroups: unknown[]; optionItems?: unknown[] }): Promise<void> {\n    if (this.useApi) {\n      await apiFetch(`/catalog/${tenantId}`, {\n        method: 'PUT',\n        body: JSON.stringify({\n          categories: catalog.categories ?? [],\n          products: catalog.products ?? [],\n          optionGroups: catalog.optionGroups ?? [],\n          optionItems: catalog.optionItems ?? [],\n        }),\n      });\n      return;\n    }\n    const { setCatalog: sc } = await import('./catalog-store');\n    sc(tenantId, {\n      categories: catalog.categories ?? [],\n      products: catalog.products ?? [],\n      optionGroups: (catalog.optionGroups ?? []) as OptionGroup[],\n      optionItems: (catalog.optionItems ?? []) as OptionItem[],\n    });\n  }\n\n  async listOrdersByTenant(tenantId: string): Promise<Order[]> {\n    if (this.useApi) {\n      return apiFetch<Order[]>(`/tenants/${encodeURIComponent(tenantId)}/orders`);\n    }\n    const { listOrdersByTenant: lot } = await import('./orders-store');\n    return lot(tenantId);\n  }\n\n  async updateOrderStatus(orderId: string, status: Order['status']): Promise<Order | null> {\n    if (this.useApi) {\n      try {\n        return await apiFetch<Order>(`/orders/${orderId}/status`, {\n          method: 'PATCH',\n          body: JSON.stringify({ status }),\n        });\n      } catch {\n        return null;\n      }\n    }\n    const { updateOrderStatus: uos } = await import('./orders-store');\n    return uos(orderId, status);\n  }\n\n  async listCampaignsApi(tenantId: string): Promise<unknown[]> {\n    if (this.useApi) {\n      return apiFetch<unknown[]>(`/campaigns?tenantId=${encodeURIComponent(tenantId)}`);\n    }\n    return listCampaigns(tenantId);\n  }\n\n  async getDeliverySettingsApi(tenantId: string): Promise<unknown | null> {\n    if (this.useApi) {\n      try {\n        return await apiFetch<unknown>(`/delivery/${tenantId}`);\n      } catch {\n        return null;\n      }\n    }\n    return getDeliverySettingsStore(tenantId);\n  }\n\n  async saveDeliverySettingsApi(tenantId: string, settings: unknown): Promise<void> {\n    if (this.useApi) {\n      await apiFetch(`/delivery/${tenantId}`, {\n        method: 'PUT',\n        body: JSON.stringify(settings),\n      });\n      return;\n    }\n    const { saveDeliverySettings } = await import('./delivery-store');\n    saveDeliverySettings(tenantId, settings as Parameters<typeof saveDeliverySettings>[1]);\n  }\n\n  async listDeliveryZonesApi(tenantId: string): Promise<DeliveryZone[]> {\n    return this.getDeliveryZones(tenantId);\n  }\n\n  async createDeliveryZoneApi(tenantId: string, zone: Omit<DeliveryZone, 'id' | 'tenantId'>): Promise<DeliveryZone> {\n    if (this.useApi) {\n      return apiFetch<DeliveryZone>(`/tenants/${tenantId}/delivery-zones`, {\n        method: 'POST',\n        body: JSON.stringify(zone),\n      });\n    }\n    const { getDeliveryZones, setDeliveryZones } = await import('./delivery-zones-store');\n    const id = generateId();\n    const newZone: DeliveryZone = { ...zone, id, tenantId };\n    const zones = [...getDeliveryZones(tenantId), newZone];\n    setDeliveryZones(tenantId, zones);\n    return newZone;\n  }\n\n  async updateDeliveryZoneApi(tenantId: string, zoneId: string, updates: Partial<Omit<DeliveryZone, 'id' | 'tenantId'>>): Promise<DeliveryZone | null> {\n    if (this.useApi) {\n      try {\n        return await apiFetch<DeliveryZone>(`/tenants/${tenantId}/delivery-zones/${zoneId}`, {\n          method: 'PUT',\n          body: JSON.stringify(updates),\n        });\n      } catch {\n        return null;\n      }\n    }\n    const { getDeliveryZones, setDeliveryZones } = await import('./delivery-zones-store');\n    const zones = getDeliveryZones(tenantId);\n    const idx = zones.findIndex((z) => z.id === zoneId);\n    if (idx === -1) return null;\n    zones[idx] = { ...zones[idx], ...updates };\n    setDeliveryZones(tenantId, zones);\n    return zones[idx];\n  }\n\n  async patchDeliveryZoneApi(tenantId: string, zoneId: string, updates: Partial<Pick<DeliveryZone, 'isActive' | 'name' | 'fee' | 'etaMinutes' | 'sortOrder'>>): Promise<DeliveryZone | null> {\n    if (this.useApi) {\n      try {\n        return await apiFetch<DeliveryZone>(`/tenants/${tenantId}/delivery-zones/${zoneId}`, {\n          method: 'PATCH',\n          body: JSON.stringify(updates),\n        });\n      } catch {\n        return null;\n      }\n    }\n    return this.updateDeliveryZoneApi(tenantId, zoneId, updates);\n  }\n\n  async deleteDeliveryZoneApi(tenantId: string, zoneId: string): Promise<boolean> {\n    if (this.useApi) {\n      try {\n        await apiFetch(`/tenants/${tenantId}/delivery-zones/${zoneId}`, { method: 'DELETE' });\n        return true;\n      } catch {\n        return false;\n      }\n    }\n    const { getDeliveryZones, setDeliveryZones } = await import('./delivery-zones-store');\n    const zones = getDeliveryZones(tenantId).filter((z) => z.id !== zoneId);\n    if (zones.length === getDeliveryZones(tenantId).length) return false;\n    setDeliveryZones(tenantId, zones);\n    return true;\n  }\n\n  async updateBrandingApi(\n    tenantId: string,\n    updates: { logoUrl?: string; hero?: import('@nmd/core').StorefrontHero; banners?: import('@nmd/core').StorefrontBanner[]; whatsappPhone?: string }\n  ): Promise<void> {\n    if (this.useApi) {\n      await apiFetch(`/tenants/${tenantId}/branding`, {\n        method: 'PUT',\n        body: JSON.stringify(updates),\n      });\n      return;\n    }\n    const { updateTenant } = await import('./tenant-registry');\n    const t = getTenantById(tenantId);\n    if (t) updateTenant(tenantId, { ...updates } as Partial<RegistryTenant>);\n  }\n\n  /** Apply quick-start template (hero, banners, categories, option groups) for a tenant. */\n  async applyTemplateApi(tenantId: string, _templateId: 'clothing'): Promise<void> {\n    const { buildClothingTemplateForTenant } = await import('./quick-start-templates');\n    const template = buildClothingTemplateForTenant(tenantId);\n\n    await this.updateBrandingApi(tenantId, {\n      hero: template.hero,\n      banners: template.banners,\n    });\n\n    const catalog = await this.getCatalogApi(tenantId);\n    await this.setCatalogApi(tenantId, {\n      categories: template.categories,\n      products: (catalog.products ?? []) as Product[],\n      optionGroups: template.optionGroups,\n    });\n  }\n}\n\nexport function getTenantListForMall(): Tenant[] {\n  if (MOCK_API_URL) return [];\n  return listEnabledTenants().map(registryToTenant);\n}\n\n/** Market tenant response shape from GET /markets/:marketId/tenants */\ninterface MarketTenantResponse {\n  id: string;\n  slug: string;\n  name: string;\n  type: string;\n  branding: { logoUrl?: string; primaryColor?: string };\n  isActive?: boolean;\n  marketCategory?: string;\n}\n\nfunction marketTenantToTenant(m: MarketTenantResponse): Tenant {\n  return {\n    id: m.id,\n    name: m.name,\n    slug: m.slug,\n    type: (m.type === 'CLOTHING' || m.type === 'FOOD') ? m.type : 'GENERAL',\n    marketCategory: (m.marketCategory as import('@nmd/core').MarketCategory) ?? 'GENERAL',\n    branding: {\n      logoUrl: m.branding?.logoUrl ?? '',\n      primaryColor: m.branding?.primaryColor ?? '#7C3AED',\n      secondaryColor: '#d4a574',\n      fontFamily: '\"Cairo\", system-ui, sans-serif',\n      radiusScale: 1,\n      layoutStyle: 'default',\n    },\n  };\n}\n\n/**\n * Fetch tenants for a market using public endpoints (no JWT).\n * @param marketSlugOrId - Market slug (e.g. 'dabburiyya') or market ID (e.g. 'market-dabburiyya'). Defaults to 'dabburiyya' when omitted.\n */\nexport async function getTenantListForMallAsync(marketSlugOrId?: string): Promise<Tenant[]> {\n  if (!MOCK_API_URL) {\n    return Promise.resolve(listEnabledTenants().map(registryToTenant));\n  }\n  const slugOrId = marketSlugOrId ?? 'dabburiyya';\n  try {\n    const isMarketId = slugOrId.startsWith('market-') || /^[0-9a-f-]{36}$/i.test(slugOrId);\n    let marketId: string;\n    if (isMarketId) {\n      marketId = slugOrId;\n    } else {\n      const market = await apiFetch<{ id: string }>(`/markets/by-slug/${slugOrId}`);\n      if (!market?.id) return [];\n      marketId = market.id;\n    }\n    const list = await apiFetch<MarketTenantResponse[]>(`/markets/${marketId}/tenants`);\n    return (Array.isArray(list) ? list : []).map(marketTenantToTenant);\n  } catch {\n    return [];\n  }\n}\n","import { seedTenants } from './seed';\r\nimport { seedCatalogForTenants } from './catalog-seed';\r\nimport { seedCampaigns } from './campaign-seed';\r\nimport { seedDelivery, seedDeliveryZones } from './delivery-seed';\r\nimport { seedTemplates } from './template-store';\r\nimport { seedStaff } from './staff-store';\r\n\r\nexport * from './types';\r\nexport * from './tenant-registry';\r\nexport * from './orders-store';\r\nexport * from './catalog-store';\r\nexport * from './campaign-store';\r\nexport * from './delivery-store';\r\nexport * from './delivery-zones-store';\r\nexport * from './template-store';\r\nexport * from './staff-store';\r\nexport * from './quick-start-templates';\r\nexport * from './mock-api-client';\r\n\r\nexport function initMock(): void {\r\n  seedTenants();\r\n  seedCatalogForTenants();\r\n  seedCampaigns();\r\n  seedDelivery();\r\n  seedDeliveryZones();\r\n  seedTemplates();\r\n  seedStaff();\r\n}\r\n"],"mappings":"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","names":["STORAGE_KEY","load","save","STORAGE_KEY","load","save","generateId","generateId","listOrdersByTenant","listTenants","saveDeliverySettings","getDeliveryZones","setDeliveryZones","updateTenant","buildClothingTemplateForTenant"]}