import{u as v,a as I,d as h,j as e,i as A,k as j,M as q}from"./index-DqbWLIhh.js";const u=new q;function O(){const{orderId:a}=v(),[y]=I(),i=y.get("tenant")??"",{data:s,isLoading:N,isError:b}=h({queryKey:["public-order",a],queryFn:async()=>{const t=await u.getPublicOrder(a);if(!t)throw new Error("NOT_FOUND");return t},enabled:!!a,retry:!1}),{data:d}=h({queryKey:["tenant",i||(s==null?void 0:s.tenantId)],queryFn:()=>u.getTenant(i||s.tenantId),enabled:!!s});return N?e.jsx("div",{className:"p-8 text-center",children:e.jsx("p",{children:"جاري التحميل..."})}):b||!s?e.jsx("div",{className:"p-8 text-center",children:e.jsx("p",{className:"text-gray-600",children:"تعذر تحميل الطلب."})}):e.jsxs("div",{className:"order-print p-8 max-w-2xl mx-auto",children:[e.jsx("style",{children:`
        @media print {
          body { print-color-adjust: exact; -webkit-print-color-adjust: exact; }
          .order-print { padding: 0; }
          .no-print { display: none !important; }
        }
      `}),e.jsxs("div",{className:"border border-gray-300 rounded-lg p-6",children:[e.jsxs("div",{className:"text-center border-b border-gray-200 pb-4 mb-4",children:[e.jsx("h1",{className:"text-xl font-bold",children:(d==null?void 0:d.name)??"المتجر"}),e.jsxs("p",{className:"text-gray-600",children:["طلب #",s.id.slice(0,8)]}),e.jsx("p",{className:"text-sm text-gray-500",children:new Date(s.createdAt).toLocaleString("ar-SA")})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"نوع التوصيل:"})," ",s.fulfillmentType==="DELIVERY"?"توصيل":"استلام"]}),s.customerName&&e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"الاسم:"})," ",s.customerName]}),s.customerPhone&&e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"الجوال:"})," ",s.customerPhone]}),s.deliveryAddress&&e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"العنوان:"})," ",s.deliveryAddress]})]}),e.jsx("div",{className:"mt-4 border-t border-gray-200 pt-4",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-start py-2",children:"المنتج"}),e.jsx("th",{className:"text-start py-2",children:"الكمية"}),e.jsx("th",{className:"text-end py-2",children:"السعر"})]})}),e.jsx("tbody",{children:s.items.map(t=>{const l=(t.selectedOptions??[]).flatMap(r=>{var o;const c=(o=t.optionGroups)==null?void 0:o.find(n=>n.id===r.optionGroupId),g="optionItemIds"in r?r.optionItemIds:[],P="optionPlacements"in r?r.optionPlacements??{}:{};return g.map(n=>{var x,p;const m=(p=(x=c==null?void 0:c.items)==null?void 0:x.find(w=>w.id===n))==null?void 0:p.name;return m?A(m,P[n]):""}).filter(Boolean)}).filter(Boolean),f=l.length>0?` (${l.join("، ")})`:"";return e.jsxs("tr",{className:"border-b",children:[e.jsxs("td",{className:"py-2",children:[t.productName,f]}),e.jsx("td",{className:"py-2",children:t.quantity}),e.jsx("td",{className:"py-2 text-end",children:j(t.totalPrice)})]},t.id)})})]})}),e.jsxs("div",{className:"mt-4 border-t border-gray-200 pt-4 flex justify-between font-bold",children:[e.jsx("span",{children:"الإجمالي"}),e.jsx("span",{children:j(s.total)})]}),s.notes&&e.jsxs("p",{className:"mt-4 text-sm text-gray-600",children:["ملاحظات: ",s.notes]})]}),e.jsx("div",{className:"no-print mt-6 text-center",children:e.jsx("button",{onClick:()=>window.print(),className:"px-4 py-2 bg-primary text-white rounded",children:"طباعة"})})]})}export{O as default};
