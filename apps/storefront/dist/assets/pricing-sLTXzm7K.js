import{g as d}from"./index-DqbWLIhh.js";function f(n){const s=[];for(const c of n.selectedOptions){const r="optionItemIds"in c?c.optionItemIds:[],e=n.optionGroups.find(i=>i.id===c.optionGroupId);if(e)for(const i of r){const t=e.items.find(o=>o.id===i);t&&s.push(t)}}return s}function l(n,s){const c=f(n),r=n.basePrice,e=c.reduce((u,a)=>u+(a.priceDelta??a.priceModifier??0),0),i=r+e,{discount:t,campaign:o}=d(i,s,n.productId,n.categoryId),p=Math.max(0,i-t);return{item:n,basePrice:r,optionDelta:e,priceBeforeDiscount:i,campaignDiscount:t,finalPrice:p,campaign:o}}function I(n,s){const c=n.map(t=>l(t,s)),r=c.reduce((t,o)=>t+o.priceBeforeDiscount*o.item.quantity,0),e=c.reduce((t,o)=>t+o.campaignDiscount*o.item.quantity,0),i=c.reduce((t,o)=>t+o.finalPrice*o.item.quantity,0);return{priced:c,subtotal:r,discountTotal:e,total:i}}export{I as p};
