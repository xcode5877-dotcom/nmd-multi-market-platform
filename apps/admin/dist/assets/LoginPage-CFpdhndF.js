import{r as n,Y as v,H as N,Z as S,j as e}from"./index-D0pSccYm.js";const f="";function C(t){if(!t||typeof t!="string")return null;const s=decodeURIComponent(t);return!s.startsWith("/")||s.startsWith("//")?null:s}function A(){const[t,s]=n.useState(""),[c,g]=n.useState(""),[i,d]=n.useState(""),[u,m]=n.useState(!1),{login:p,token:b}=v(),o=N(),[w]=S(),x=C(w.get("returnTo"));async function j(a){a.preventDefault(),d(""),m(!0);try{await p(t.trim(),c);const r=await fetch(`${f}/auth/me`,{headers:{Authorization:`Bearer ${localStorage.getItem("nmd-access-token")}`}});if(!r.ok)throw new Error("Failed to fetch user");const l=await r.json();if(l.tenantId){const h=await fetch(`${f}/tenants/by-id/${l.tenantId}`,{headers:{Authorization:`Bearer ${localStorage.getItem("nmd-access-token")}`}});if(h.ok){const y=await h.json();o(`/?tenant=${encodeURIComponent(y.slug??l.tenantId)}`,{replace:!0});return}}o(x??"/",{replace:!0})}catch(r){d(r instanceof Error?r.message:"Login failed")}finally{m(!1)}}return b?(o(x??"/",{replace:!0}),null):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-[#0F172A]",children:e.jsxs("div",{className:"w-full max-w-sm p-6 bg-[#1E293B] rounded-xl border border-[#334155] shadow-xl",children:[e.jsx("h1",{className:"text-xl font-bold text-white text-center mb-6",children:"تسجيل دخول المتجر"}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"البريد الإلكتروني"}),e.jsx("input",{type:"email",value:t,onChange:a=>s(a.target.value),className:"w-full px-3 py-2 bg-[#334155] text-white rounded-lg border border-[#475569] focus:border-[#7C3AED] focus:outline-none",placeholder:"ms-brands@nmd.com",required:!0,autoComplete:"email"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"كلمة المرور"}),e.jsx("input",{type:"password",value:c,onChange:a=>g(a.target.value),className:"w-full px-3 py-2 bg-[#334155] text-white rounded-lg border border-[#475569] focus:border-[#7C3AED] focus:outline-none",required:!0,autoComplete:"current-password"})]}),i&&e.jsx("p",{className:"text-red-400 text-sm",children:i}),e.jsx("button",{type:"submit",disabled:u,className:"w-full py-2 bg-[#7C3AED] hover:bg-[#6D28D9] disabled:opacity-50 text-white font-medium rounded-lg transition-colors",children:u?"جاري تسجيل الدخول...":"تسجيل الدخول"})]}),e.jsx("p",{className:"mt-4 text-xs text-gray-500 text-center",children:"البريد: <tenantSlug>@nmd.com — كلمة المرور: <tenantSlug>@2026"})]})})}export{A as default};
