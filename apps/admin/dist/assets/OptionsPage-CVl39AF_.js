import{u as z,r as d,v as w,j as e,B as i,C as f,t as F,o as b,q as u,w as j,s as y,x as A,y as E,z as B,A as $}from"./index-D0pSccYm.js";function R(){const{tenantId:c,tenantType:S}=z(),[N,C]=d.useState([]),k=w(S,N),[t,m]=d.useState(null),[T,x]=d.useState(!1),[D,h]=d.useState(!1),[l,r]=d.useState({name:"",required:!1,minSelected:0,maxSelected:1,selectionType:"single"}),[n,o]=d.useState({name:"",priceDelta:0,enabled:!0,defaultSelected:!1}),g=n.id,p=()=>C(j(c));d.useEffect(()=>{p()},[c]);const I=()=>{if(!l.name.trim())return;const s={id:(t==null?void 0:t.id)??y(),tenantId:c,name:l.name,required:l.required,minSelected:l.minSelected,maxSelected:l.maxSelected,selectionType:l.selectionType,items:(t==null?void 0:t.items)??[]};A(c,s),p(),m(s),x(!1),r({name:"",required:!1,minSelected:0,maxSelected:1,selectionType:"single"})},O=s=>{E(c,s),(t==null?void 0:t.id)===s&&m(null),p()},q=()=>{var a;if(!t||!n.name.trim())return;const s={id:g??y(),groupId:t.id,name:n.name,priceDelta:n.priceDelta,sortOrder:((a=t.items)==null?void 0:a.length)??0,enabled:n.enabled,defaultSelected:n.defaultSelected};B(c,t.id,s),p(),m(j(c).find(M=>M.id===t.id)??t)},G=s=>{t&&($(c,t.id,s),p(),m(j(c).find(a=>a.id===t.id)??null))},v=s=>s.selectionType==="single"?"اختيار واحد":`اختيار حتى ${s.maxSelected}`;return e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("div",{className:"w-72 flex-shrink-0",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"مجموعات الخيارات"}),e.jsx(i,{size:"sm",onClick:()=>{m(null),r({name:"",required:!1,minSelected:0,maxSelected:1,selectionType:"single"}),x(!0)},children:"إضافة"})]}),e.jsx(f,{children:e.jsx("div",{className:"divide-y divide-gray-200",children:k.map(s=>e.jsxs("div",{className:`p-3 cursor-pointer ${(t==null?void 0:t.id)===s.id?"bg-primary/10":"hover:bg-gray-50"}`,onClick:()=>m(s),children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsx("span",{className:"text-gray-500 text-sm block",children:v(s)})]},s.id))})})]}),e.jsx("div",{className:"flex-1",children:t?e.jsxs(f,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-bold",children:t.name}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{variant:"outline",size:"sm",onClick:()=>{r({name:t.name,required:t.required,minSelected:t.minSelected,maxSelected:t.maxSelected,selectionType:t.selectionType}),x(!0)},children:"تعديل المجموعة"}),e.jsx(i,{size:"sm",onClick:()=>{o({name:"",priceDelta:0,enabled:!0,defaultSelected:!1}),h(!0)},children:"إضافة خيار"}),e.jsx(i,{variant:"ghost",size:"sm",className:"text-red-600",onClick:()=>O(t.id),children:"حذف المجموعة"})]})]}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:v(t)}),e.jsx("div",{className:"divide-y divide-gray-200",children:(t.items??[]).map(s=>e.jsxs("div",{className:"flex justify-between items-center py-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsxs("span",{className:"text-gray-500 text-sm me-2",children:[(s.priceDelta??s.priceModifier??0)>=0?"+":"",F(s.priceDelta??s.priceModifier??0)]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(i,{variant:"ghost",size:"sm",onClick:()=>{o({id:s.id,name:s.name,priceDelta:s.priceDelta??s.priceModifier??0,enabled:s.enabled??!0,defaultSelected:s.defaultSelected??!1}),h(!0)},children:"تعديل"}),e.jsx(i,{variant:"ghost",size:"sm",className:"text-red-600",onClick:()=>G(s.id),children:"حذف"})]})]},s.id))})]}):e.jsx(f,{className:"p-12 text-center text-gray-500",children:"اختر مجموعة أو أضف جديدة"})}),e.jsxs(b,{open:T,onClose:()=>x(!1),title:t?"تعديل مجموعة":"إضافة مجموعة",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(u,{label:"الاسم",value:l.name,onChange:s=>r(a=>({...a,name:s.target.value}))}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:l.required,onChange:s=>r(a=>({...a,required:s.target.checked}))}),"مطلوب"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"نوع الاختيار"}),e.jsxs("select",{value:l.selectionType,onChange:s=>r(a=>({...a,selectionType:s.target.value})),className:"w-full border rounded px-3 py-2",children:[e.jsx("option",{value:"single",children:"اختيار واحد"}),e.jsx("option",{value:"multi",children:"اختيار متعدد"})]})]}),e.jsx(u,{label:"الحد الأدنى",type:"number",value:l.minSelected,onChange:s=>r(a=>({...a,minSelected:+s.target.value}))}),e.jsx(u,{label:"الحد الأقصى",type:"number",value:l.maxSelected,onChange:s=>r(a=>({...a,maxSelected:+s.target.value}))})]}),e.jsxs("div",{className:"mt-6 flex gap-2",children:[e.jsx(i,{onClick:I,children:"حفظ"}),e.jsx(i,{variant:"ghost",onClick:()=>x(!1),children:"إلغاء"})]})]}),e.jsxs(b,{open:D,onClose:()=>h(!1),title:g?"تعديل خيار":"إضافة خيار",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(u,{label:"الاسم",value:n.name,onChange:s=>o(a=>({...a,name:s.target.value}))}),e.jsx(u,{label:"التعديل على السعر (₪)",type:"number",value:n.priceDelta,onChange:s=>o(a=>({...a,priceDelta:+s.target.value}))}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:n.enabled,onChange:s=>o(a=>({...a,enabled:s.target.checked}))}),"مفعّل"]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:n.defaultSelected,onChange:s=>o(a=>({...a,defaultSelected:s.target.checked}))}),"محدد افتراضياً"]})]}),e.jsxs("div",{className:"mt-6 flex gap-2",children:[e.jsx(i,{onClick:q,children:"حفظ"}),e.jsx(i,{variant:"ghost",onClick:()=>h(!1),children:"إلغاء"})]})]})]})}export{R as default};
